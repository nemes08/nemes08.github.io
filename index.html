<script src="https://sdk.minepi.com/pi-sdk.js"></script>
<script>
  Pi.init({
    version: "2.0",
    sandbox: true
  });

  const BACKEND_URL = "https://pi-trust-market-backend.onrender.com";

  async function startPayment(amount) {
    try {
      // ğŸ” Pi kimlik doÄŸrulama
      const auth = await Pi.authenticate(["payments"]);

      // ğŸ“¡ Backendâ€™e Ã¶deme isteÄŸi
      const res = await fetch(`${BACKEND_URL}/create-payment`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          amount: Number(amount),
          memo: "Pi Trust Market Ã–deme",
          uid: auth.user.uid
        })
      });

      if (!res.ok) {
        throw new Error("Backend Ã¶deme oluÅŸturamadÄ±");
      }

      const paymentData = await res.json();

      // ğŸ’° Pi Ã¶deme ekranÄ±
      const payment = await Pi.createPayment(paymentData);

      console.log("Ã–deme baÅŸarÄ±lÄ±:", payment);
      alert("Ã–deme baÅŸlatÄ±ldÄ± ğŸš€");

    } catch (err) {
      console.error("Ã–deme hatasÄ±:", err);
      alert("Ã–deme baÅŸlatÄ±lamadÄ± âŒ");
    }
  }
</script>
